<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ãƒ“ãƒƒã‚¯ãƒªãƒãƒ³ãƒãƒ§ã‚³ - ã‚·ãƒ¼ãƒ«å‡ºç¾ç‡</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="rarity.css">
</head>
<body>
    <div class="container">
        <h1>ã‚·ãƒ¼ãƒ«ã®å‡ºç¾ç‡ä¸€è¦§</h1>
        <p><a href="index.html" class="back-link">&laquo; ãƒ“ãƒƒã‚¯ãƒªãƒãƒ³ãƒãƒ§ã‚³ã«æˆ»ã‚‹</a></p>
        <div id="rarity-list">
            <!-- ã“ã“ã«JavaScriptã§ãƒªã‚¹ãƒˆãŒç”Ÿæˆã•ã‚Œã¾ã™ -->
        </div>
    </div>
    <script src="image-data.js"></script>
    <script>
        // ğŸ–¼ï¸ ç”»åƒãƒ‡ãƒ¼ã‚¿ã¯ image-data.js ã‹ã‚‰ allImagesData ã‚’å‚ç…§
        const imagesData = allImagesData;

        document.addEventListener('DOMContentLoaded', function() {
            const rarityListElement = document.getElementById('rarity-list');
            if (!rarityListElement) return;

            // imagesDataã‚’ã‚½ãƒ¼ãƒˆã™ã‚‹
            // 1. weight ã®é™é † (é«˜ã„ã‚‚ã®ãŒå…ˆé ­)
            // 2. weight ãŒåŒã˜å ´åˆã¯ã€å…ƒã®é…åˆ—ã®é †åºã‚’ç¶­æŒã™ã‚‹ (å®‰å®šã‚½ãƒ¼ãƒˆã®æŒ™å‹•ã«ä¾å­˜)
            const sortedImagesData = [...imagesData].sort((a, b) => {
                const weightA = a.weight || 0;
                const weightB = b.weight || 0;

                if (weightB !== weightA) {
                    return weightB - weightA; // weight ã®é™é †
                }
                // weight ãŒåŒã˜å ´åˆã¯ã€å…ƒã®é †åºã‚’ç¶­æŒã™ã‚‹ãŸã‚ 0 ã‚’è¿”ã™
                // (JavaScriptã®sortã¯ES2019ä»¥é™ã§å®‰å®šã‚½ãƒ¼ãƒˆãŒä¿è¨¼ã•ã‚Œã¦ã„ã¾ã™)
                return 0;
            });

            const totalWeight = sortedImagesData.reduce((sum, img) => sum + (img.weight || 0), 0);

            if (totalWeight <= 0) {
                rarityListElement.innerHTML = '<p>å‡ºç¾ç‡ã‚’è¨ˆç®—ã§ãã¾ã›ã‚“ã§ã—ãŸã€‚</p>';
                return;
            }

            const ul = document.createElement('ul');
            ul.className = 'rarity-items';

            sortedImagesData.forEach(image => { // ã‚½ãƒ¼ãƒˆæ¸ˆã¿ã®é…åˆ—ã‚’ä½¿ç”¨
                const percentage = ((image.weight || 0) / totalWeight) * 100;
                const listItem = document.createElement('li');
                listItem.className = 'rarity-item';

                const imgElement = document.createElement('img');
                imgElement.src = image.src;
                imgElement.alt = image.description;
                imgElement.className = 'rarity-image';

                const descriptionElement = document.createElement('p');
                descriptionElement.className = 'rarity-description';
                descriptionElement.textContent = image.description;

                const percentageElement = document.createElement('p');
                percentageElement.className = 'rarity-percentage';
                percentageElement.textContent = `å‡ºç¾ç‡: ${percentage.toFixed(2)}%`; // å°æ•°ç‚¹ä»¥ä¸‹2æ¡ã§è¡¨ç¤º

                listItem.appendChild(imgElement);
                listItem.appendChild(descriptionElement);
                listItem.appendChild(percentageElement);
                ul.appendChild(listItem);
            });
            rarityListElement.appendChild(ul);
        });
    </script>
</body>
</html>